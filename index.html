<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Zul" />
  <meta name="description" content="Notes on wave and simulation" />
  <title>Notes on Coursera’s Computers, Waves, Simulations</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Notes on Coursera’s Computers, Waves, Simulations</h1>
<p class="author">Zul</p>
</header>
<h4 id="wave-equation">3-1. Wave Equation</h4>
<p>Acoustic/scalar wave equation <span
class="math display">\partial^{2}_{t} p = c^{2} \Delta p +s</span></p>
<p>where <span class="math inline">p</span> is pressure, <span
class="math inline">\Delta</span> is the Laplacian operator, containing
second derivatives in space namely <span
class="math inline">\partial^{2}_{x} p + \partial^{2}_{y} p +
\partial^{2}_{z} p</span>, <span class="math inline">c</span> is the
propagation velocity, and <span class="math inline">s</span> is the
source term.</p>
<p><span class="math inline">p</span> is a function of space <span
class="math inline">x</span> and time <span
class="math inline">t</span>. <span class="math inline">s</span> is
space-dependet but does not depend on time. <span
class="math inline">s</span> depends on both space and time.</p>
<p>This represents for instance propagation of sound waves.</p>
<h4 id="algorithm">3-2. Algorithm</h4>
<ins>
Space-time discretization
</ins>
<p>Space is discretized horizontally by dots. Distance between dots is
<span class="math inline">dx</span>. Index each dot by <span
class="math inline">j</span>.</p>
<p>Modify continuous <span class="math inline">x</span> to be <span
class="math inline">x_{j} = jdx, j = [0,j_{max}]</span>.</p>
<p>Time is discretized vertically the same way. Distance between dots is
<span class="math inline">dt</span>. Access time with <span
class="math inline">\cdots, n-1, n, n+1, \cdots</span>.</p>
<p><span class="math inline">t_n = ndt, n = [0, n_{max}]</span>.</p>
<ins>
Consequence for fields
</ins>
<p>Move from continuous form <span class="math inline">p(x,t)</span> to
discrete form <span class="math inline">p_{j}^{n}</span></p>
<p><span class="math inline">p(x_{j}, t_{n} + dt) \rightarrow
p_{j}^{n+1}</span>.</p>
<ins>
Finite difference for wave equation
</ins>
<p>Wave equation on 1D: <span class="math display">\partial^{2}_{t}
p(x,t) = c^{2}(x) \partial^{2}_{x} p(x,t) +s(x,t)</span></p>
<p><span class="math inline">\partial^{2}_{t} p(x,t) \rightarrow
\dfrac{p_{j}^{n+1} - 2p_{j}^{n} + p_{j}^{n-1}}{dt^{2}}</span></p>
<p><span class="math inline">\partial^{2}_{x} p(x,t) \rightarrow
\dfrac{p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}}{dx^{2}}</span></p>
<p><span class="math inline">\implies \dfrac{p_{j}^{n+1} - 2p_{j}^{n} +
p_{j}^{n-1}}{dt^{2}} = c^2 \dfrac{p_{j+1}^{n} - 2p_{j}^{n} +
p_{j-1}^{n}}{dx^{2}} + s_{j}^{n}</span></p>
<p><span class="math inline">\implies</span> <span
class="math inline">p</span> at point <span class="math inline">j</span>
is defined at 3 different times, <span
class="math inline">n+1,n,n-1</span></p>
<p><span class="math inline">\implies</span> <ins>Extrapolation
problem</ins>. Isolate <span class="math inline">p</span> at <span
class="math inline">j</span> for <span class="math inline">n+1</span>
(future), and put everything else on the right hand side</p>
<p><span class="math inline">\implies</span> <span
class="math inline">p_{j}^{n+1} = c_{j}^{2}
\frac{dt^{2}}{dx^{2}}[p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}] +
2p_{j}^{n} - p_{j}^{n-1} + dt^{2}s_{j}^{n}</span>, which is called
<ins>fully explicit scheme</ins> because we can write the future based
on what we know in the present and the past.</p>
<h4 id="boundaries-sources">3-3. Boundaries, Sources</h4>
<ins>
Boundary conditions
</ins>
<p>Set the pressure to zero at the edges. Reflects a perfectly
reflecting boundary – energy that goes to the sides will come back
in.</p>
<p><span class="math inline">p(x = 0,t) = 0</span></p>
<p><span class="math inline">p(x = x_{max},t)=0</span></p>
<ins>
Initial conditions
</ins>
<p><span class="math inline">p(x, t = 0) = 0</span></p>
<p><span class="math inline">\partial_{t}p(x, t=0) = 0</span></p>
<ins>
Source terms
</ins>
<p>If we solve pde, often make use of delta functions <span
class="math display">\begin{equation}
  \delta(x)=\begin{cases}
    \infty, &amp; \text{at $x=0$}.\\
    0, &amp; \text{otherwise}.
  \end{cases}
\end{equation}</span></p>
<p>The integral is equal to one</p>
<p><span class="math display"> \int_{\infty}^{\infty} \delta(x)dx
=1</span></p>
<p>Compare our numerical solution with that of analytic, using Green’s
function.</p>
<ins>
<p>Box <span class="math inline">\delta</span>-generating function
(space) </inf></p>
<p><span class="math display">\begin{equation}
  \delta_{bc}(x)=\begin{cases}
    \frac{1}{dx}, &amp; \text{for $x \leq\frac{dx}{2}$}.\\
    0, &amp; \text{otherwise}.
  \end{cases}
\end{equation}</span></p>
<p>As <span class="math inline">dx \rightarrow 0</span>, this function
converges to the delta function.</p>
<ins>
<p>Gaussian <span class="math inline">\delta</span>-generating function
(time) </inf></p>
<p><span class="math display">\delta_{a}(t) = \dfrac{1}{\sqrt{2\pi
a}}e^{-t^{2}/2a}</span></p>
<p>As <span class="math inline">a \rightarrow 0</span>, this function
converges to the delta function</p>
<p><span class="math inline">\implies</span> finite approximation have
the properties of integral equal to one</p>
<p><span class="math display">\int_{-\infty}^{+\infty} \delta_{bc} (x)
dx = 1</span></p>
<p><span class="math display">\int_{-\infty}^{+\infty} \delta_{a} (x) dx
= 1</span></p>
<ins>
Dirac delta function <span class="math inline">\delta(x)</span>
</ins>
<p><span class="math display">\int_{-\infty}^{\infty} f(x) \delta(x-a) =
f(a)</span></p>
<p>Using discrete version of the Dirac delta function allows us to
numerically approximate Green’s function, and compare with analytical
solutions.</p>
<ins>
Source-time function
</ins>
<p>We can denote the grid point, along space, to be <span
class="math inline">j_s</span> to indicate the source that corresponds
to where discrete version of delta function is injected. (the point
where we introduce the source term)</p>
<p>In the beginning everything is at rest, and then progressively during
the simulation, we will start injecting energy at this particular
point.</p>
<p><span class="math inline">s(x,t) = \delta(x-x_{s})f(t)</span></p>
<p>Often use first derivative of Gaussian function:</p>
<p><span class="math inline">f(t) =
-8f_{0}(t-t_{0})e^{-\frac{1}{4f_{0}^{2}}(t-t_{0})^{2}}</span>. Think has
an error. Should be <span class="math inline">f(t) =
-8f_{0}(t-t_{0})e^{-(4f_{0})^{2}(t-t_{0})^{2}}</span></p>
<p>where <span class="math inline">f_0</span> is the dominat frequency –
often used for a wave simulation.</p>
<p>What is dominant frequency? E.g. in spectral space, taking the
fourier transform, obtain the amplitude spectrum of that function. It
containes a lot of frequencies, but the dominant energy is at frequency
<span class="math inline">f_0</span>.</p>
<p><img src="./images/dominant_freq.png" /></p>
<p>Why use the first derivative of a Gaussian function to initialize the
source-time function if we want a Gaussian waveform as solution to the
1D wave equation? &gt; The resulting signal is an integral of the source
time function.</p>
<h4 id="initialization">3-4. Initialization</h4>
<p>Setting up the space-time discretization.</p>
<p>Key questions are: + what are the spatial wavelengths? + always make
use of the relation between velocity, wave number and wavelength + <span
class="math inline">c = \omega/k = \lambda/T</span>, where <span
class="math inline">\omega</span> is the temporal frequency, <span
class="math inline">k</span> is wavenumber, <span
class="math inline">\lambda</span> is the wavelength, and <span
class="math inline">T</span> the period.</p>
<ins>
A physical problem
</ins>
<p><span class="math inline">c = \lambda/T = \lambda f</span></p>
<p><span class="math inline">c = 343</span> m/s</p>
<p><span class="math inline">f_{1} = 20</span> Hz <span
class="math inline">\rightarrow \lambda_{1} = 17m</span></p>
<p><span class="math inline">f_{2} = 50</span> Hz <span
class="math inline">\rightarrow \lambda_{2} = 7m</span></p>
<p>Number of points per wavelength: Discretize the smallest spatial
wavelength in the field i.e., 50Hz, 7m.</p>
<p><span class="math inline">\implies</span> smallest spatial
wavelength</p>
<p><span class="math inline">\implies</span> appropriately sampled.</p>
<p>Similarly, appropriate sampling in time.</p>
<p>Let <span class="math inline">dx = 0.5m</span> and <span
class="math inline">dt = 0.0012s</span>.</p>
<p>Spatial domain of 10km, and inject a source-time function with shape
of the first derivative of a Gaussian function.</p>
<p><img src="./images/w3_init.png" /></p>
<ins>
Python
</ins>
<p>Recap finite-difference approximation of the 1D wave equation:</p>
<p><span class="math inline">\implies</span> <span
class="math inline">p_{j}^{n+1} = c_{j}^{2}
\frac{dt^{2}}{dx^{2}}[p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}] +
2p_{j}^{n} - p_{j}^{n-1} + dt^{2}s_{j}^{n}</span></p>
<p>Graphically, we start at the second point because we dont calculate
points at the boundaries.</p>
<p><img src="./images/w3_j.png" /></p>
<p>Then we sequentially move to <span
class="math inline">j+4</span>.</p>
<p><img src="./images/w3_j1.png" /></p>
<p><img src="./images/w3_j2.png" /></p>
<p><img src="./images/w3_j3.png" /></p>
<p><img src="./images/w3_j4.png" /></p>
</body>
</html>
