<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Zul" />
  <meta name="description" content="Notes on wave and simulation" />
  <title>Notes on Coursera’s Computers, Waves, Simulations</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Notes on Coursera’s Computers, Waves, Simulations</h1>
<p class="author">Zul</p>
</header>
<h4 id="wave-equation">3-1. Wave Equation</h4>
<p>Acoustic/scalar wave equation <span
class="math display">\partial^{2}_{t} p = c^{2} \Delta p +s</span></p>
<p>where <span class="math inline">p</span> is pressure, <span
class="math inline">\Delta</span> is the Laplacian operator, containing
second derivatives in space namely <span
class="math inline">\partial^{2}_{x} p + \partial^{2}_{y} p +
\partial^{2}_{z} p</span>, <span class="math inline">c</span> is the
propagation velocity, and <span class="math inline">s</span> is the
source term.</p>
<p><span class="math inline">p</span> is a function of space <span
class="math inline">x</span> and time <span
class="math inline">t</span>. <span class="math inline">c</span> is
space-dependant but does not depend on time. <span
class="math inline">s</span> depends on both space and time.</p>
<p>This represents for instance propagation of sound waves.</p>
<h4 id="algorithm">3-2. Algorithm</h4>
<ins>
Space-time discretization
</ins>
<p>Space is discretized horizontally by dots. Distance between dots is
<span class="math inline">dx</span>. Index each dot by <span
class="math inline">j</span>.</p>
<p>Modify continuous <span class="math inline">x</span> to be <span
class="math inline">x_{j} = jdx, j = [0,j_{max}]</span>.</p>
<p>Time is discretized vertically the same way. Distance between dots is
<span class="math inline">dt</span>. Access time with <span
class="math inline">\cdots, n-1, n, n+1, \cdots</span>.</p>
<p><span class="math inline">t_n = ndt, n = [0, n_{max}]</span>.</p>
<ins>
Consequence for fields
</ins>
<p>Move from continuous form <span class="math inline">p(x,t)</span> to
discrete form <span class="math inline">p_{j}^{n}</span></p>
<p><span class="math inline">p(x_{j}, t_{n} + dt) \rightarrow
p_{j}^{n+1}</span>.</p>
<ins>
Finite difference for wave equation
</ins>
<p>Wave equation on 1D: <span class="math display">\partial^{2}_{t}
p(x,t) = c^{2}(x) \partial^{2}_{x} p(x,t) +s(x,t)</span></p>
<p><span class="math inline">\partial^{2}_{t} p(x,t) \rightarrow
\dfrac{p_{j}^{n+1} - 2p_{j}^{n} + p_{j}^{n-1}}{dt^{2}}</span></p>
<p><span class="math inline">\partial^{2}_{x} p(x,t) \rightarrow
\dfrac{p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}}{dx^{2}}</span></p>
<p><span class="math inline">\implies \dfrac{p_{j}^{n+1} - 2p_{j}^{n} +
p_{j}^{n-1}}{dt^{2}} = c^2 \dfrac{p_{j+1}^{n} - 2p_{j}^{n} +
p_{j-1}^{n}}{dx^{2}} + s_{j}^{n}</span></p>
<p><span class="math inline">\implies</span> <span
class="math inline">p</span> at point <span class="math inline">j</span>
is defined at 3 different times, <span
class="math inline">n+1,n,n-1</span></p>
<p><span class="math inline">\implies</span> <ins>Extrapolation
problem</ins>. Isolate <span class="math inline">p</span> at <span
class="math inline">j</span> for <span class="math inline">n+1</span>
(future), and put everything else on the right hand side</p>
<p><span class="math inline">\implies</span> <span
class="math inline">p_{j}^{n+1} = c_{j}^{2}
\frac{dt^{2}}{dx^{2}}[p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}] +
2p_{j}^{n} - p_{j}^{n-1} + dt^{2}s_{j}^{n}</span>, which is called
<ins>fully explicit scheme</ins> because we can write the future based
on what we know in the present and the past.</p>
<h4 id="boundaries-sources">3-3. Boundaries, Sources</h4>
<ins>
Boundary conditions
</ins>
<p>Set the pressure to zero at the edges. Reflects a perfectly
reflecting boundary – energy that goes to the sides will come back
in.</p>
<p><span class="math inline">p(x = 0,t) = 0</span></p>
<p><span class="math inline">p(x = x_{max},t)=0</span></p>
<ins>
Initial conditions
</ins>
<p><span class="math inline">p(x, t = 0) = 0</span></p>
<p><span class="math inline">\partial_{t}p(x, t=0) = 0</span></p>
<ins>
Source terms
</ins>
<p>If we solve pde, often make use of delta functions <span
class="math display">\begin{equation}
  \delta(x)=\begin{cases}
    \infty, &amp; \text{at $x=0$}.\\
    0, &amp; \text{otherwise}.
  \end{cases}
\end{equation}</span></p>
<p>The integral is equal to one</p>
<p><span class="math display"> \int_{\infty}^{\infty} \delta(x)dx
=1</span></p>
<p>Compare our numerical solution with that of analytic, using Green’s
function.</p>
<ins>
Box <span class="math inline">\delta</span>-generating function (space)
</ins>
<p><span class="math display">\begin{equation}
  \delta_{bc}(x)=\begin{cases}
    \frac{1}{dx}, &amp; \text{for $x \leq\frac{dx}{2}$}.\\
    0, &amp; \text{otherwise}.
  \end{cases}
\end{equation}</span></p>
<p>As <span class="math inline">dx \rightarrow 0</span>, this function
converges to the delta function.</p>
<ins>
Gaussian <span class="math inline">\delta</span>-generating function
(time)
</ins>
<p><span class="math display">\delta_{a}(t) = \dfrac{1}{\sqrt{2\pi
a}}e^{-t^{2}/2a}</span></p>
<p>As <span class="math inline">a \rightarrow 0</span>, this function
converges to the delta function</p>
<p><span class="math inline">\implies</span> finite approximation have
the properties of integral equal to one</p>
<p><span class="math display">\int_{-\infty}^{+\infty} \delta_{bc} (x)
dx = 1</span></p>
<p><span class="math display">\int_{-\infty}^{+\infty} \delta_{a} (x) dx
= 1</span></p>
<ins>
Dirac delta function <span class="math inline">\delta(x)</span>
</ins>
<p><span class="math display">\int_{-\infty}^{\infty} f(x) \delta(x-a) =
f(a)</span></p>
<p>Using discrete version of the Dirac delta function allows us to
numerically approximate Green’s function, and compare with analytical
solutions.</p>
<ins>
Source-time function
</ins>
<p>We can denote the grid point, along space, to be <span
class="math inline">j_s</span> to indicate the source that corresponds
to where discrete version of delta function is injected. (the point
where we introduce the source term)</p>
<p>In the beginning everything is at rest, and then progressively during
the simulation, we will start injecting energy at this particular
point.</p>
<p><span class="math inline">s(x,t) = \delta(x-x_{s})f(t)</span></p>
<p>Often use first derivative of Gaussian function:</p>
<p><span class="math inline">f(t) =
-8f_{0}(t-t_{0})e^{-\frac{1}{4f_{0}^{2}}(t-t_{0})^{2}}</span>. Think has
an error. Should be <span class="math inline">f(t) =
-8f_{0}(t-t_{0})e^{-(4f_{0})^{2}(t-t_{0})^{2}}</span></p>
<p>where <span class="math inline">f_0</span> is the dominat frequency –
often used for a wave simulation.</p>
<p>What is dominant frequency? E.g. in spectral space, taking the
fourier transform, obtain the amplitude spectrum of that function. It
containes a lot of frequencies, but the dominant energy is at frequency
<span class="math inline">f_0</span>.</p>
<p><img src="./images/dominant_freq.png" /></p>
<p>Why use the first derivative of a Gaussian function to initialize the
source-time function if we want a Gaussian waveform as solution to the
1D wave equation? &gt; The resulting signal is an integral of the source
time function.</p>
<h4 id="initialization">3-4. Initialization</h4>
<p>Setting up the space-time discretization.</p>
<p>Key questions are: + what are the spatial wavelengths? + always make
use of the relation between velocity, wave number and wavelength + <span
class="math inline">c = \omega/k = \lambda/T</span>, where <span
class="math inline">\omega</span> is the temporal frequency, <span
class="math inline">k</span> is wavenumber, <span
class="math inline">\lambda</span> is the wavelength, and <span
class="math inline">T</span> the period.</p>
<ins>
A physical problem
</ins>
<p><span class="math inline">c = \lambda/T = \lambda f</span></p>
<p><span class="math inline">c = 343</span> m/s</p>
<p><span class="math inline">f_{1} = 20</span> Hz <span
class="math inline">\rightarrow \lambda_{1} = 17m</span></p>
<p><span class="math inline">f_{2} = 50</span> Hz <span
class="math inline">\rightarrow \lambda_{2} = 7m</span></p>
<p>Number of points per wavelength: Discretize the smallest spatial
wavelength in the field i.e., 50Hz, 7m.</p>
<p><span class="math inline">\implies</span> smallest spatial
wavelength</p>
<p><span class="math inline">\implies</span> appropriately sampled.</p>
<p>Similarly, appropriate sampling in time.</p>
<p>Let <span class="math inline">dx = 0.5m</span> and <span
class="math inline">dt = 0.0012s</span>.</p>
<p>Spatial domain of 10km, and inject a source-time function with shape
of the first derivative of a Gaussian function.</p>
<p><img src="./images/w3_init.png" /></p>
<ins>
Python
</ins>
<p>Recap finite-difference approximation of the 1D wave equation:</p>
<p><span class="math inline">\implies</span> <span
class="math inline">p_{j}^{n+1} = c_{j}^{2}
\frac{dt^{2}}{dx^{2}}[p_{j+1}^{n} - 2p_{j}^{n} + p_{j-1}^{n}] +
2p_{j}^{n} - p_{j}^{n-1} + dt^{2}s_{j}^{n}</span></p>
<p>Graphically, we start at the second point because we dont calculate
points at the boundaries.</p>
<p><img src="./images/w3_j.png" /></p>
<p>Then we sequentially move to <span
class="math inline">j+4</span>.</p>
<p><img src="./images/w3_j1.png" /></p>
<p><img src="./images/w3_j2.png" /></p>
<p><img src="./images/w3_j3.png" /></p>
<p><img src="./images/w3_j4.png" /></p>
<h4 id="waves-in-1d">3-5. Waves in 1D</h4>
<p>Number of grids is <span class="math inline">10,000</span></p>
<p>Max domain is <span class="math inline">10,000</span></p>
<p>Grid points distance <span class="math inline">dx</span> is max
domain divided by (number of grids minus 1).</p>
<p>Max time domain is <span class="math inline">1,000</span>.</p>
<p>Grid points distance <span class="math inline">dt</span> is set at
<span class="math inline">0.02</span>.</p>
<p>Using first derivative of Gaussian function: + Dominant frequency
<span class="math inline">f_0</span> is 25 + Source time shift <span
class="math inline">t_0</span> is 4</p>
<hr />
<p>If we increase the frequency by twice, then we are decreasing the
spatial wavelength by half + <span class="math inline">c = \lambda
f</span> + It also means we have less grid points per wavelength. Why?
Because <span class="math inline">dx</span> stays the same.</p>
<p>What happens if we increase the frequency? The waveform will
disintegrate – called <em>numerical dispersion</em>.</p>
<p>What happens if we increase the time increment <span
class="math inline">dt</span>? + Solution exploded.</p>
<h4 id="waves-in-1d-python-lab">3-5.1. Waves in 1D (Python Lab)</h4>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Libraries </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>matplotlib.use(<span class="st">&quot;nbagg&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&quot;nbagg&quot; enables interactive figures in a live IPython notebook session.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sub-plot Configuration</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> gridspec </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies the geometry of the grid that a subplot will be placed. The number of rows and number of columns of the grid need to be set.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ignore Warning Messages</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#========================</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter Configuration </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>nx   <span class="op">=</span> <span class="dv">10000</span>        <span class="co"># number of grid points in x-direction</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>xmax <span class="op">=</span> <span class="dv">10000</span>        <span class="co"># physical domain (m)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>dx   <span class="op">=</span> xmax<span class="op">/</span>(nx<span class="op">-</span><span class="dv">1</span>)  <span class="co"># grid point distance in x-direction</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>c0   <span class="op">=</span> <span class="fl">334.</span>         <span class="co"># wave speed in medium (m/s)</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>isrc <span class="op">=</span> <span class="bu">int</span>(nx<span class="op">/</span><span class="dv">2</span>)    <span class="co"># source location in grid in x-direction</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>nt   <span class="op">=</span> <span class="dv">1001</span>         <span class="co"># maximum number of time steps</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># we use 1,0001, because later on, we will loop fromm 0,1,...,1000</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>dt   <span class="op">=</span> <span class="fl">0.0010</span>       <span class="co"># time step</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Source time function parameters</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>f0   <span class="op">=</span> <span class="fl">25.</span> <span class="co"># dominant frequency of the source (Hz)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>t0   <span class="op">=</span> <span class="fl">4.</span> <span class="op">/</span> f0 <span class="co"># source time shift</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Source Time Function</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Source time function (Gaussian)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>src  <span class="op">=</span> np.zeros(nt <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#produce zero vectors of length nt+1 = 1,002. Not sure why this is necessary, since you already have another src assigned below</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.linspace(<span class="dv">0</span> <span class="op">*</span> dt, nt <span class="op">*</span> dt, nt)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#produce a time vector starting from zero, ending with nt*dt = 1.001, with nt grid points (1,001). i wonder why dont we use time = np.linspace(0 * dt, (nt-1) * dt, nt), which will also produce 1,001 grid points, but starting from 0 to 1.</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st derivative of a Gaussian</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>src  <span class="op">=</span> <span class="op">-</span><span class="fl">8.</span> <span class="op">*</span> (time <span class="op">-</span> t0) <span class="op">*</span> f0 <span class="op">*</span> (np.exp(<span class="op">-</span><span class="fl">1.0</span> <span class="op">*</span> (<span class="dv">4</span><span class="op">*</span>f0) <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> (time <span class="op">-</span> t0) <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#produce a vector of length nt=1,001, corresponding to &quot;time&quot; variable. ie src domain is time, not space</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot source time function</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot position configuration</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>plt.ion()</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Enable interactive mode</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>fig1 <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>gs1  <span class="op">=</span> gridspec.GridSpec(<span class="dv">1</span>, <span class="dv">2</span>, width_ratios<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>], hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#matplotlib.gridspec.GridSpec(nrows, ncols, figure=None, left=None, bottom=None, right=None, top=None, wspace=&lt;The amount of width reserved for space between subplots, expressed as a fraction of the average axis width.&gt;, hspace=&lt;The amount of height reserved for space between subplots, expressed as a fraction of the average axis height.&gt;, width_ratios=&lt;Defines the relative widths of the columns.&gt;, height_ratios=None)[source]</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot source time function</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>ax1  <span class="op">=</span> plt.subplot(gs1[<span class="dv">0</span>])</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>ax1.plot(time, src) <span class="co"># plot source time function</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Recall that time starts from zero, ending with nt*dt = 1.001, with nt grid points (1,001)</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Source Time Function&#39;</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>ax1.set_xlim(time[<span class="dv">0</span>], time[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Time (s)&#39;</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Amplitude&#39;</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot source spectrum</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>ax2  <span class="op">=</span> plt.subplot(gs1[<span class="dv">1</span>])</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>spec <span class="op">=</span> np.fft.fft(src) <span class="co"># source time function in frequency domain</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># computes the one-dimensional n-point discrete Fourier Transform (DFT) with the efficient Fast Fourier Transform (FFT) algorithm [CT].</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> np.fft.fftfreq(spec.size, d <span class="op">=</span> dt ) <span class="co"># time domain to frequency domain</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co">#Given a window length n and a sample spacing d:</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co">#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even.</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co">#Eg if n is 8, then [0,1,2,3,-4,-3,-2,-1]/(d*8)</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="co">#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co">#eg if n is 9, then [0,1,2,3,4,-4,-3,-2,-1]/(d*9)</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.<span class="bu">abs</span>(freq), np.<span class="bu">abs</span>(spec)) <span class="co"># plot frequency and amplitude</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(<span class="dv">0</span>, <span class="dv">250</span>) <span class="co"># only display frequency from 0 to 250 Hz</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Source Spectrum&#39;</span>)</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Frequency (Hz)&#39;</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Amplitude&#39;</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.tick_right()</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.set_label_position(<span class="st">&quot;right&quot;</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="./images/w3_l1p1.png" /></p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Snapshot &amp; Seismogram </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize empty pressure</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>p    <span class="op">=</span> np.zeros(nx) <span class="co"># p at time n (now)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#produce vector of zeros of length nx = 10,000</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#note that p&#39;s domain is space, not time</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pold <span class="op">=</span> np.zeros(nx) <span class="co"># p at time n-1 (past)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>pnew <span class="op">=</span> np.zeros(nx) <span class="co"># p at time n+1 (present)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>d2px <span class="op">=</span> np.zeros(nx) <span class="co"># 2nd space derivative of p</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize model (assume homogeneous model)</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>c    <span class="op">=</span> np.zeros(nx)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>c    <span class="op">=</span> c <span class="op">+</span> c0       <span class="co"># initialize wave velocity in model</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#produce a vector with a constant value c = 334 of length nx = 10,000 </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize coordinate</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>x    <span class="op">=</span> np.arange(nx)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#produce a vector [0,1,2,...,9999]</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>x    <span class="op">=</span> x <span class="op">*</span> dx       <span class="co"># coordinate in x-direction</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#produce a vector corresponding to each grid points in space, [0,1*dx,2*dx,...,9999]</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot position configuration</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plt.ion()</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>fig2  <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>gs2   <span class="op">=</span> gridspec.GridSpec(<span class="dv">1</span>,<span class="dv">1</span>,width_ratios<span class="op">=</span>[<span class="dv">1</span>],hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1D wave propagation</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: comma is needed to update the variable</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>ax3  <span class="op">=</span> plt.subplot(gs2[<span class="dv">0</span>])</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>leg1,<span class="op">=</span> ax3.plot(isrc, <span class="dv">0</span>, <span class="st">&#39;r*&#39;</span>, markersize<span class="op">=</span><span class="dv">11</span>) <span class="co"># plot position of the source in snapshot</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>up31,<span class="op">=</span> ax3.plot(p) <span class="co"># plot pressure update each time step</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">#plot p y-axis, while x-axis is space grid. i wonder why we dont put ax3.plot(x,p)  instead.</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(<span class="dv">0</span>, xmax)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="op">-</span>np.<span class="bu">max</span>(p), np.<span class="bu">max</span>(p))</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Time Step (nt) = 0&#39;</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;x (m)&#39;</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Pressure Amplitude&#39;</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="./images/w3_l1p2.png" /></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1D Wave Propagation (Finite Difference Solution) </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#intuition: for each time period, we update the pressure chart above, which is in space domain.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over time</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> it <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#loop over grid points across times, nt = 1,001, ie from 0,1,2,...,1000</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2nd derivative in space</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nx <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        d2px[i] <span class="op">=</span> (p[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> p[i] <span class="op">+</span> p[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">/</span> dx <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#at grid point t=0, update second derivative of pressure at space grid 1 (depend on point 2, point 1 and point 0). Continue, until reach space grid 9,998 (depends on point 9999,9998,9997). Note that 9,999 is the last grid (don&#39;t be confused by grid value, which is 9,999 x dt = 10,000)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Time Extrapolation</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ------------------</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    pnew <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> p <span class="op">-</span> pold <span class="op">+</span> c <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> dt <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> d2px</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is extrapolation scheme with source term zero</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># intuitively, given same space grid point i, we update the pressure at time grid point it - denoted by pnew, which depends on p at time it-1 (pold), p at time now (p) and second derivatives at space grid point i</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#note that p.size is 10,000</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add Source Term at isrc</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -----------------------</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Absolute pressure w.r.t analytical solution</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    pnew[isrc] <span class="op">=</span> pnew[isrc] <span class="op">+</span> src[it] <span class="op">/</span> (dx) <span class="op">*</span> dt <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># why src is divided by dx tho? it&#39;s not in the formula. I think we divide src by dx here because of BC generating function. s = bc function * 1st derivative of gaussian function. (bc function: delta(x) = 1/dx if |dx| less than 1/2, 0 otherwise)</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remap Time Levels</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -----------------</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    pold, p <span class="op">=</span> p, pnew</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot pressure field</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># -------------------------------------</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (it <span class="op">%</span> idisp) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        ax3.set_title(<span class="st">&#39;Time Step (nt) = </span><span class="sc">%d</span><span class="st">&#39;</span> <span class="op">%</span> it)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        ax3.set_ylim(<span class="op">-</span><span class="fl">1.1</span><span class="op">*</span>np.<span class="bu">max</span>(<span class="bu">abs</span>(p)), <span class="fl">1.1</span><span class="op">*</span>np.<span class="bu">max</span>(<span class="bu">abs</span>(p)))</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># plot around propagating wave</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        window<span class="op">=</span><span class="dv">100</span><span class="op">;</span>xshift<span class="op">=</span><span class="dv">25</span> <span class="co">#wtf do we need this xshift for? it just shift the frame lower. may as well just adjust window?</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">#having difficulty understanding below. but i know c0 =m/s, while it*dt = s --&gt; multiply both convert time to space</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        ax3.set_xlim(isrc<span class="op">*</span>dx<span class="op">+</span>c0<span class="op">*</span>it<span class="op">*</span>dt<span class="op">-</span>window<span class="op">*</span>dx<span class="op">-</span>xshift, isrc<span class="op">*</span>dx<span class="op">+</span>c0<span class="op">*</span>it<span class="op">*</span>dt<span class="op">+</span>window<span class="op">*</span>dx<span class="op">-</span>xshift) </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        up31.set_ydata(p)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        plt.gcf().canvas.draw()</span></code></pre></div>
<h4 id="analytical-solution">3-6. Analytical solution</h4>
<p>Wave equation on 1D: <span class="math display">\partial^{2}_{t}
p(x,t) = c^{2}(x) \partial^{2}_{x} p(x,t) +s(x,t)</span></p>
<p>Assume no source term:</p>
<p><span class="math display">\partial^{2}_{t} p(x,t) - c^{2}(x)
\partial^{2}_{x} p(x,t) =  0</span></p>
<p>Initial conditions</p>
<p><span class="math display">p(x,t=0)=p_{0}(x)</span> <span
class="math display">\partial_{t}p(x,t=0)=0</span></p>
<p>Analytical solution <span class="math inline">\implies p(x,t) =
1/2p_{0}(ct-x) +1/2p_{0}(ct+x)</span></p>
<p>What happens if the intial conditions <span
class="math inline">p(x=0,t=0)=C</span> where <span
class="math inline">C</span> is constant?</p>
<p>There might be problems, such that an initial condition contain very
high frequencies, that are not supported by numerical algorithm.</p>
<p>Assume with source term:</p>
<p><span class="math inline">\implies</span> Green function to find
analytical solutions.</p>
<p>Delta functions:</p>
<p><span class="math display">\begin{equation}
  \delta(x)=\begin{cases}
    \infty, &amp; \text{at $x=0$}.\\
    0, &amp; \text{otherwise}.
  \end{cases}
\end{equation}</span></p>
<p>The integral is equal to one</p>
<p><span class="math display"> \int_{\infty}^{\infty} \delta(x)dx
=1</span></p>
<p>The solution to source term at <span class="math inline">x_0
t_0</span> is the Greens function <span class="math inline">G(x,t;x_0 ,
t_0)</span></p>
<p><span class="math inline">\partial^{2}_{t}G(x,t;x_0, t_0) -
c^2\partial_{x}^{2}G(x,t;x_0 , t_0) = \delta (x-x_0
)\delta(t-t_0)</span></p>
<p>The solution contains Heaviside function (integral of delta
function):</p>
<p><span class="math display">\begin{equation}
  H(x)=\begin{cases}
    0, &amp; \text{at $x&lt;0$}.\\
    1, &amp; \text{at $x \geq 0$}.
  \end{cases}
\end{equation}</span></p>
<p>Solution for wave equation is an integral of the source time
function</p>
<p><img src="./images/gf_solution.png" /></p>
<p>Recall the convolution theorem for linear systems. In light of this,
consider a differential equation of the form <span
class="math inline">d^{2}u/dx^{2} = f(x)</span> where <span
class="math inline">f</span> is some forcing function, in the domain
<span class="math inline">x\in [0,L]</span>. What is the solution to
this equation, given green’s function <span
class="math inline">G(x,x_0)</span></p>
<p><span class="math inline">\implies u(x) = G(x,x_0)*f(x)</span>, where
* is convolution</p>
<h4 id="python-lab">3-7. Python lab</h4>
<p>If we enter any source time function, we expect the integral of the
source time function to propagate away from the source point without any
change in waveform.</p>
<p>Benchmarking - we know the analytical solution, quantify the
difference between numerical and analytical solution - to verify the
accuracy of the former.</p>
<p><em>Zul’s monologue: Why would we want numerical solution if we
already have analytical solution?</em></p>
<h4 id="von-neumann-analysis">3-8. Von Neumann Analysis</h4>
<h4 id="summary">3-9. Summary</h4>
<ins>
Wrap up
</ins>
<ol type="1">
<li>Finite difference of acoustic wave equation, simulated in
python</li>
<li>Simulation:</li>
</ol>
<ul>
<li>Explosion</li>
<li>Dispersion</li>
</ul>
<ol start="3" type="1">
<li>Von Neumann Analysis</li>
</ol>
<ul>
<li>CFL-criterion, <span class="math inline">cdt/x \leq \epsilon =
1</span></li>
</ul>
</body>
</html>
